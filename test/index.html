<!DOCTYPE html>
<script src="simonsson.js"></script>
<style>
	#result .binding {
		display: flex;
	}
	#result .binding .combo,
	#result .binding .hit {
		flex: 1 1;
	}
	#result .binding .hit.hot {
		background-color: black;
		font-weight: bold;
		color: white;
	}
</style>
<template id="binding">
	<div class="binding">
		<div class="combo">
			<!-- Key combination -->
		</div>
		<div class="hit">
			<!-- Was activated? -->
		</div>
	</div>
</template>
<h1>Simonsson test playground</h1>
<p id="mounted">Not initialized</p>
<div id="result"></div>
<input type="text" id="inputText" />
<input type="checkbox" id="inputCheckbox" />
<textarea id="textarea"></textarea>
<button>Dummy</button>

<script>
	;(function () {
		const YES = 'Yes'
		const NO = 'No'

		const bindings = []
		Simonsson.init().then(() => {
			document.getElementById('mounted').textContent = 'Simonsson is initialized'
		})

		const bindCombo = (combo, options, clb) => {
			const template = document.getElementById('binding')
			const bindRow = template.content.cloneNode(true)
			bindRow.querySelector('.combo').textContent = combo
			bindRow.querySelector('.hit').textContent = 'No'
			document.getElementById('result').appendChild(bindRow)
			const inserted = document.getElementById('result').lastElementChild
			inserted.dataset['combo'] = combo
			Simonsson.bind(
				combo,
				() => {
					const hitCell = inserted.querySelector('.hit')
					hitCell.textContent = YES
					hitCell.classList.add('hot')
					if (typeof clb === 'function') clb()
				},
				options
			)
		}

		const resetState = (combo) => {
			document.querySelector(`.binding[data-combo="${combo}"] .hit`).textContent = NO
			document.querySelector(`.binding[data-combo="${combo}"] .hit`).classList.remove('hot')
		}

		const resetAllStates = () => {
			const allStates = document.querySelectorAll(`.binding .hit`)
			allStates.forEach((element) => {
				element.textContent = NO
				element.classList.remove('hot')
			})
		}

		window.bindCombo = bindCombo
		window.resetState = resetState
		window.resetAllStates = resetAllStates
	})()
</script>
